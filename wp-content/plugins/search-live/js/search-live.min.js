/*!
 * search-live.js
 *
 * Copyright (c) "kento" Karim Rahimpur www.itthinx.com
 *
 * This code is released under the GNU General Public License.
 * See COPYRIGHT.txt and LICENSE.txt.
 *
 * This code is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * This header and all notices must be kept intact.
 *
 * @author itthinx
 * @package search-live
 * @since 1.0.0
 */
;var ixsl={doPost:true,blinkerTimeouts:[],blinkerTimeout:5000};(function(a){ixsl.inhibitEnter=function(b){a("#"+b).keydown(function(c){if(c.keyCode==13){c.preventDefault();return false}})};ixsl.dynamicFocus=function(d,c){var e=a("#"+d),b=a("#"+c);e.focusout(function(g){var f=a(this);setTimeout(function(){var h=(f.find(":focus").length>0);if(!h){b.hide()}},162)});e.focusin(function(h){var g=a(this),f=g.find("input.search-live-field");if(f.length>0){if(a(f[0]).val().length==0){b.html("")}}b.show()})};ixsl.navigate=function(c,b){a("#"+c).keydown(function(m){var h=0,g=false,k=false;switch(m.keyCode){case 37:break;case 39:break;case 38:h=-1;break;case 40:h=1;break;case 13:g=true;break;case 27:k=true;break}if(h!=0){var d=a("#"+b).find(".entry"),l=a("#"+b+" .entry.active").index();if(d.length>0){if(l>=0){a(d[l]).removeClass("active")}l+=h;if(l<0){l=d.length-1}else{if(l>=d.length){l=0}}a(d[l]).addClass("active")}m.preventDefault();return false}if(g){var d=a("#"+b).find(".entry"),l=a("#"+b+" .entry.active").index();if((l>=0)&&(l<d.length)){var j=a(d[l]).find("a").get(0);if(typeof j!=="undefined"){var f=a(j).attr("href");if(typeof f!=="undefined"){m.preventDefault();ixsl.doPost=false;document.location=f;return false}}}}if(k){var d=a("#"+b).find(".entry"),l=a("#"+b+" .entry.active").index();if(d.length>0){if(l>=0){a(d[l]).removeClass("active")}}m.preventDefault();return false}})};ixsl.autoAdjust=function(d,c){var e=a("#"+d),b=a("#"+c);b.on("adjustWidth",function(g){g.stopPropagation();var f=e.outerWidth()-(b.outerWidth()-b.innerWidth());b.width(f)});a(window).on("resize",function(f){b.trigger("adjustWidth")})};ixsl.searchLive=function(h,g,c,b,j,i){if(!ixsl.doPost){return}if(typeof i==="undefined"){i={}}var k=a("#"+c),e=a("#"+h),d=ixsl.blinkerTimeout;if(typeof i.blinkerTimeout!=="undefined"){d=i.blinkerTimeout}j=a.trim(j);if(j!=""){e.addClass("blinker");if(d>0){ixsl.blinkerTimeouts["#"+h]=setTimeout(function(){e.removeClass("blinker")},d)}var f={action:"search_live","search-live":1,"search-live-query":j};if(typeof i.lang!=="undefined"){f.lang=i.lang}a.post(b,f,function(n){var o="";if((n!==null)&&(n.length>0)){var v=null,s=null,m=true,r=false;if(typeof i.thumbnails!=="undefined"){m=i.thumbnails}if(typeof i.show_description!=="undefined"){r=i.show_description}o+='<table class="search-results">';for(var t in n){var q="";if(s!=n[t].type){s=n[t].type;q="first"}if(v!=n[t].result_type){v=n[t].result_type}o+='<tr class="entry '+n[t].result_type+" "+n[t].type+" "+q+'">';if(m){o+='<td class="result-image">';o+='<a href="'+n[t].url+'" title="'+n[t].title+'">';if(typeof n[t].thumbnail!=="undefined"){var l="",u="",p="";if(typeof n[t].thumbnail_alt!=="undefined"){p=' alt="'+n[t].thumbnail_alt+'" '}if(typeof n[t].thumbnail_width!=="undefined"){l=' width="'+n[t].thumbnail_width+'" '}if(typeof n[t].thumbnail_height!=="undefined"){u=' height="'+n[t].thumbnail_height+'" '}o+='<img class="thumbnail" src="'+n[t].thumbnail+'" '+p+l+u+"/>"}o+="</a>";o+="</td>"}o+='<td class="result-info">';o+='<a href="'+n[t].url+'" title="'+n[t].title+'">';o+='<span class="title">'+n[t].title+"</span>";if(r){if(typeof n[t].description!=="undefined"){o+='<span class="description">'+n[t].description+"</span>"}}o+="</a>";o+="</td>";o+="</tr>"}o+="</table>"}else{if(typeof i.no_results!=="undefined"){if(i.no_results.length>0){o+='<div class="no-results">';o+=i.no_results;o+="</div>"}}}k.show().html(o);ixsl.clickable(c);k.trigger("adjustWidth");e.removeClass("blinker");if(d>0){clearTimeout(ixsl.blinkerTimeouts["#"+h])}},"json")}else{k.hide().html("")}};ixsl.clickable=function(b){a("#"+b+" table.search-results tr").click(function(){var c=a(this).find("a").attr("href");if(c){window.location=c}});a("#"+b+" table.search-results tr").css("cursor","pointer")}})(jQuery);